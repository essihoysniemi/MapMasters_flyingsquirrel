<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <link rel="stylesheet" href="css/leaflet-measure.css">
        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title></title>
    </head>
    <body>
        <div id="map">
        </div>
        <script src="js/qgis2web_expressions.js"></script>
        <script src="js/leaflet.js"></script>
        <script src="js/L.Control.Layers.Tree.min.js"></script>
        <script src="js/multi-style-layer.js"></script>
        <script src="js/leaflet.rotatedMarker.js"></script>
        <script src="js/leaflet.pattern.js"></script>
        <script src="js/leaflet-hash.js"></script>
        <script src="js/Autolinker.min.js"></script>
        <script src="js/rbush.min.js"></script>
        <script src="js/labelgun.min.js"></script>
        <script src="js/labels.js"></script>
        <script src="js/leaflet-measure.js"></script>
        <script src="data/smallerroad_1.js"></script>
        <script src="data/clearcutarea2024_3.js"></script>
        <script src="data/clearcutarea2022_4.js"></script>
        <script src="data/clearcutarea2021_5.js"></script>
        <script src="data/clearcutarea2020_6.js"></script>
        <script src="data/openstand2018_7.js"></script>
        <script src="data/railway_8.js"></script>
        <script src="data/majorroad_9.js"></script>
        <script src="data/mainexamplearea_11.js"></script>
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet-timedimension/1.3.0/leaflet.timedimension.css" />
		<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-timedimension/1.3.0/leaflet.timedimension.js"></script>
		<script src="https://unpkg.com/leaflet.pattern/leaflet.pattern.min.js"></script>
		<link rel="stylesheet" href="https://unpkg.com/leaflet.pattern/leaflet.pattern.css">
        <script>
        var highlightLayer;
		function zoomToFeature(e) {map.fitBounds(e.target.getBounds({padding: [200, 200]})); }
        function highlightFeature(e) {
            highlightLayer = e.target;

            if (e.target.feature.geometry.type === 'LineString' || e.target.feature.geometry.type === 'MultiLineString') {
              highlightLayer.setStyle({
                color: '#ffff00',
              });
            } else {
              highlightLayer.setStyle({
                fillColor: '#ffff00',
                fillOpacity: 1
              });
            }
        }
        var map = L.map('map', {
            zoomControl:false, maxZoom:28, minZoom:2
        }).fitBounds([[60.23061894317262,21.12207173632029],[61.06333086300848,24.40499694946378]]);
		L.control.scale({ 
				position: 'bottomleft',  
				metric: true,            
				imperial: false        
		}).addTo(map);
		     var title = new L.Control({position: 'topleft'}); 
				title.onAdd = function (map) { 
				this._div = L.DomUtil.create('div', 'info'); 
				this.update(); 
				return this._div; 
			}; 
				title.update = function () { 
				this._div.innerHTML = '<h2>Suitable habitats of flying squirrel and risks</h2>'; 
			}; 

				title.addTo(map); 
				
			var abstract = new L.Control({'position':'bottomleft'}); 
            abstract.onAdd = function (map) { 
                this._div = L.DomUtil.create('div', 
                'leaflet-control abstract'); 
                this._div.id = 'abstract' 
                    this._div.setAttribute("onmouseenter", "abstract.show()"); 
                    this._div.setAttribute("onmouseleave", "abstract.hide()"); 
                    this.hide(); 
                    return this._div; 
                }; 
                abstract.hide = function () { 
                    this._div.classList.remove("abstractUncollapsed"); 
                    this._div.classList.add("abstract"); 
                    this._div.innerHTML = 'i' 	 
				} 

                abstract.show = function () { 
                    this._div.classList.remove("abstract"); 
                    this._div.classList.add("abstractUncollapsed"); 
                    this._div.innerHTML = 'The web map showcases the spatial distribution of suitable habitats for flying squirrels in Southwest Finland, along with potential human-related risks to these areas. The risk level layer presents the most affected areas from 2018 to 2024. The map includes also selected example areas that have been heavily impacted or bigger habitat areas that have experienced minimal disturbance. The map incorporates data on flying squirrel habitats from Laji.fi, the road and railway data from Väylävirasto, open stand from Suomen ympäristökeskus and clear-cuts from Metsäkeskus. The map provides insights into biodiversity in the area by focusing on the well-known indicator species. '; 
		}; 

        abstract.addTo(map); 
        var hash = new L.Hash(map);
        map.attributionControl.setPrefix('<a href="https://laji.fi/about/5922" target="_blank">Laji.fi CC BY 4.0</a> &middot;<a href="https://vayla.fi/vaylista/aineistot/avoindata" target="_blank">Suomen väylät CC BY 4.0</a> &middot;<a href="https://ckan.ymparisto.fi/dataset/%7B5B8976FE-334A-4216-92A5-1FC7670E7AFE%7D" target="_blank">Corine Land Cover CC BY 4.0</a> &middot;<a href="https://www.metsakeskus.fi/fi/avoin-metsa-ja-luontotieto/aineistot-paikkatieto-ohjelmille/paikkatietoaineistot" title="A JS library for interactive maps">Metsäkeskus CC BY 4.0</a> &middot; <a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a> &middot; <a href="https://github.com/tomchadwin/qgis2web" target="_blank">qgis2web</a> &middot; <a href="https://qgis.org">QGIS</a>');
        var autolinker = new Autolinker({truncate: {length: 30, location: 'smart'}});
        // remove popup's row if "visible-with-data"
        function removeEmptyRowsFromPopupContent(content, feature) {
         var tempDiv = document.createElement('div');
         tempDiv.innerHTML = content;
         var rows = tempDiv.querySelectorAll('tr');
         for (var i = 0; i < rows.length; i++) {
             var td = rows[i].querySelector('td.visible-with-data');
             var key = td ? td.id : '';
             if (td && td.classList.contains('visible-with-data') && feature.properties[key] == null) {
                 rows[i].parentNode.removeChild(rows[i]);
             }
         }
         return tempDiv.innerHTML;
        }
        // add class to format popup if it contains media
		function addClassToPopupIfMedia(content, popup) {
			var tempDiv = document.createElement('div');
			tempDiv.innerHTML = content;
			if (tempDiv.querySelector('td img')) {
				popup._contentNode.classList.add('media');
					// Delay to force the redraw
					setTimeout(function() {
						popup.update();
					}, 10);
			} else {
				popup._contentNode.classList.remove('media');
			}
		}
        var zoomControl = L.control.zoom({
            position: 'topleft'
        }).addTo(map);
        var measureControl = new L.Control.Measure({
            position: 'topleft',
            primaryLengthUnit: 'meters',
            secondaryLengthUnit: 'kilometers',
            primaryAreaUnit: 'sqmeters',
            secondaryAreaUnit: 'hectares'
        });
        measureControl.addTo(map);
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].innerHTML = '';
        document.getElementsByClassName('leaflet-control-measure-toggle')[0].className += ' fas fa-ruler';
        var bounds_group = new L.featureGroup([]);
        function setBounds() {
        }
        map.createPane('pane_basemap_0');
        map.getPane('pane_basemap_0').style.zIndex = 400;
        var layer_basemap_0 = L.tileLayer('http://services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}', {
            pane: 'pane_basemap_0',
            opacity: 1.0,
            attribution: '',
            minZoom: 2,
            maxZoom: 28,
            minNativeZoom: 0,
            maxNativeZoom: 20
        });
        layer_basemap_0;
        map.addLayer(layer_basemap_0);
        function pop_smallerroad_1(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['fid'] !== null ? autolinker.link(feature.properties['fid'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_smallerroad_1_0() {
            return {
                pane: 'pane_smallerroad_1',
                opacity: 1,
                color: 'rgba(35,35,35,0.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(0,0,0,1.0)',
                interactive: false,
            }
        }
        map.createPane('pane_smallerroad_1');
        map.getPane('pane_smallerroad_1').style.zIndex = 401;
        map.getPane('pane_smallerroad_1').style['mix-blend-mode'] = 'normal';
        var layer_smallerroad_1 = new L.geoJson(json_smallerroad_1, {
            attribution: '',
            interactive: false,
            dataVar: 'json_smallerroad_1',
            layerName: 'layer_smallerroad_1',
            pane: 'pane_smallerroad_1',
            onEachFeature: pop_smallerroad_1,
            style: style_smallerroad_1_0,
        });
        bounds_group.addLayer(layer_smallerroad_1);
        map.addLayer(layer_smallerroad_1);
        map.createPane('pane_flyingsquirrelshabitat_2');
        map.getPane('pane_flyingsquirrelshabitat_2').style.zIndex = 402;
        var img_flyingsquirrelshabitat_2 = 'data/flyingsquirrelshabitat_2.png';
        var img_bounds_flyingsquirrelshabitat_2 = [[60.06334346772763,21.198141274245366],[61.15043351783161,23.959382050616302]];
        var layer_flyingsquirrelshabitat_2 = new L.imageOverlay(img_flyingsquirrelshabitat_2,
                                              img_bounds_flyingsquirrelshabitat_2,
                                              {pane: 'pane_flyingsquirrelshabitat_2'});
        bounds_group.addLayer(layer_flyingsquirrelshabitat_2);
        map.addLayer(layer_flyingsquirrelshabitat_2);
        function pop_clearcutarea2024_3(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">area_ha</th>\
                        <td class="visible-with-data" id="area_ha">' + (feature.properties['area_ha'] !== null ? autolinker.link(feature.properties['area_ha'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">year_</th>\
                        <td class="visible-with-data" id="year_">' + (feature.properties['year_'] !== null ? autolinker.link(feature.properties['year_'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        var pattern_clearcutarea2024_3_0 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#f40808',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 315
        });
        pattern_clearcutarea2024_3_0.addTo(map);
        function style_clearcutarea2024_3_0() {
            return {
                pane: 'pane_clearcutarea2024_3',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2024_3_0,
                interactive: true,
            }
        }
        var pattern_clearcutarea2024_3_1 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#f40808',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 225
        });
        pattern_clearcutarea2024_3_1.addTo(map);
        function style_clearcutarea2024_3_1() {
            return {
                pane: 'pane_clearcutarea2024_3',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2024_3_1,
                interactive: true,
            }
        }
        function style_clearcutarea2024_3_2() {
            return {
                pane: 'pane_clearcutarea2024_3',
                opacity: 1,
                color: 'rgba(244,8,8,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
                interactive: true,
            }
        }
        map.createPane('pane_clearcutarea2024_3');
        map.getPane('pane_clearcutarea2024_3').style.zIndex = 403;
        map.getPane('pane_clearcutarea2024_3').style['mix-blend-mode'] = 'normal';
        var layer_clearcutarea2024_3 = new L.geoJson.multiStyle(json_clearcutarea2024_3, {
            attribution: '',
            interactive: true,
            dataVar: 'json_clearcutarea2024_3',
            layerName: 'layer_clearcutarea2024_3',
            pane: 'pane_clearcutarea2024_3',
            onEachFeature: pop_clearcutarea2024_3,
            styles: [style_clearcutarea2024_3_0,style_clearcutarea2024_3_1,style_clearcutarea2024_3_2,]
        });
        bounds_group.addLayer(layer_clearcutarea2024_3);
        map.addLayer(layer_clearcutarea2024_3);
        function pop_clearcutarea2022_4(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">area_ha</th>\
                        <td class="visible-with-data" id="area_ha">' + (feature.properties['area_ha'] !== null ? autolinker.link(feature.properties['area_ha'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">year_</th>\
                        <td class="visible-with-data" id="year_">' + (feature.properties['year_'] !== null ? autolinker.link(feature.properties['year_'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        var pattern_clearcutarea2022_4_0 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#f90909',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 315
        });
        pattern_clearcutarea2022_4_0.addTo(map);
        function style_clearcutarea2022_4_0() {
            return {
                pane: 'pane_clearcutarea2022_4',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2022_4_0,
                interactive: true,
            }
        }
        var pattern_clearcutarea2022_4_1 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#f90909',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 225
        });
        pattern_clearcutarea2022_4_1.addTo(map);
        function style_clearcutarea2022_4_1() {
            return {
                pane: 'pane_clearcutarea2022_4',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2022_4_1,
                interactive: true,
            }
        }
        function style_clearcutarea2022_4_2() {
            return {
                pane: 'pane_clearcutarea2022_4',
                opacity: 1,
                color: 'rgba(249,9,9,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
                interactive: true,
            }
        }
        map.createPane('pane_clearcutarea2022_4');
        map.getPane('pane_clearcutarea2022_4').style.zIndex = 404;
        map.getPane('pane_clearcutarea2022_4').style['mix-blend-mode'] = 'normal';
        var layer_clearcutarea2022_4 = new L.geoJson.multiStyle(json_clearcutarea2022_4, {
            attribution: '',
            interactive: true,
            dataVar: 'json_clearcutarea2022_4',
            layerName: 'layer_clearcutarea2022_4',
            pane: 'pane_clearcutarea2022_4',
            onEachFeature: pop_clearcutarea2022_4,
            styles: [style_clearcutarea2022_4_0,style_clearcutarea2022_4_1,style_clearcutarea2022_4_2,]
        });
        bounds_group.addLayer(layer_clearcutarea2022_4);
        map.addLayer(layer_clearcutarea2022_4);
        function pop_clearcutarea2021_5(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">area_ha</th>\
                        <td class="visible-with-data" id="area_ha">' + (feature.properties['area_ha'] !== null ? autolinker.link(feature.properties['area_ha'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">year_</th>\
                        <td class="visible-with-data" id="year_">' + (feature.properties['year_'] !== null ? autolinker.link(feature.properties['year_'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        var pattern_clearcutarea2021_5_0 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#b10505',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 315
        });
        pattern_clearcutarea2021_5_0.addTo(map);
        function style_clearcutarea2021_5_0() {
            return {
                pane: 'pane_clearcutarea2021_5',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2021_5_0,
                interactive: true,
            }
        }
        var pattern_clearcutarea2021_5_1 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#b10505',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 225
        });
        pattern_clearcutarea2021_5_1.addTo(map);
        function style_clearcutarea2021_5_1() {
            return {
                pane: 'pane_clearcutarea2021_5',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2021_5_1,
                interactive: true,
            }
        }
        function style_clearcutarea2021_5_2() {
            return {
                pane: 'pane_clearcutarea2021_5',
                opacity: 1,
                color: 'rgba(245,6,6,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
                interactive: true,
            }
        }
        map.createPane('pane_clearcutarea2021_5');
        map.getPane('pane_clearcutarea2021_5').style.zIndex = 405;
        map.getPane('pane_clearcutarea2021_5').style['mix-blend-mode'] = 'normal';
        var layer_clearcutarea2021_5 = new L.geoJson.multiStyle(json_clearcutarea2021_5, {
            attribution: '',
            interactive: true,
            dataVar: 'json_clearcutarea2021_5',
            layerName: 'layer_clearcutarea2021_5',
            pane: 'pane_clearcutarea2021_5',
            onEachFeature: pop_clearcutarea2021_5,
            styles: [style_clearcutarea2021_5_0,style_clearcutarea2021_5_1,style_clearcutarea2021_5_2,]
        });
        bounds_group.addLayer(layer_clearcutarea2021_5);
        map.addLayer(layer_clearcutarea2021_5);
        function pop_clearcutarea2020_6(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">area_ha</th>\
                        <td class="visible-with-data" id="area_ha">' + (feature.properties['area_ha'] !== null ? autolinker.link(feature.properties['area_ha'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">year_</th>\
                        <td class="visible-with-data" id="year_">' + (feature.properties['year_'] !== null ? autolinker.link(feature.properties['year_'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        var pattern_clearcutarea2020_6_0 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#fa0202',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 315
        });
        pattern_clearcutarea2020_6_0.addTo(map);
        function style_clearcutarea2020_6_0() {
            return {
                pane: 'pane_clearcutarea2020_6',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2020_6_0,
                interactive: true,
            }
        }
        var pattern_clearcutarea2020_6_1 = new L.StripePattern({
            weight: 0.3,
            spaceWeight: 2.0,
            color: '#fa0202',
            opacity: 1.0,
            spaceOpacity: 0,
            angle: 225
        });
        pattern_clearcutarea2020_6_1.addTo(map);
        function style_clearcutarea2020_6_1() {
            return {
                pane: 'pane_clearcutarea2020_6',
                stroke: false,
                fillOpacity: 1,
                fillPattern: pattern_clearcutarea2020_6_1,
                interactive: true,
            }
        }
        function style_clearcutarea2020_6_2() {
            return {
                pane: 'pane_clearcutarea2020_6',
                opacity: 1,
                color: 'rgba(250,2,2,1.0)',
                dashArray: '',
                lineCap: 'square',
                lineJoin: 'bevel',
                weight: 1.0,
                fillOpacity: 0,
                interactive: true,
            }
        }
        map.createPane('pane_clearcutarea2020_6');
        map.getPane('pane_clearcutarea2020_6').style.zIndex = 406;
        map.getPane('pane_clearcutarea2020_6').style['mix-blend-mode'] = 'normal';
        var layer_clearcutarea2020_6 = new L.geoJson.multiStyle(json_clearcutarea2020_6, {
            attribution: '',
            interactive: true,
            dataVar: 'json_clearcutarea2020_6',
            layerName: 'layer_clearcutarea2020_6',
            pane: 'pane_clearcutarea2020_6',
            onEachFeature: pop_clearcutarea2020_6,
            styles: [style_clearcutarea2020_6_0,style_clearcutarea2020_6_1,style_clearcutarea2020_6_2,]
        });
        bounds_group.addLayer(layer_clearcutarea2020_6);
        map.addLayer(layer_clearcutarea2020_6);
        function pop_openstand2018_7(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">year</th>\
                        <td class="visible-with-data" id="year">' + (feature.properties['year'] !== null ? autolinker.link(feature.properties['year'].toLocaleString()) : '') + '</td>\
                    </tr>\
                    <tr>\
                        <th scope="row">area_ha</th>\
                        <td class="visible-with-data" id="area_ha">' + (feature.properties['area_ha'] !== null ? autolinker.link(feature.properties['area_ha'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_openstand2018_7_0() {
            return {
                pane: 'pane_openstand2018_7',
                opacity: 1,
                color: 'rgba(35,35,35,0.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(251,154,153,0.49411764705882355)',
                interactive: true,
            }
        }
        map.createPane('pane_openstand2018_7');
        map.getPane('pane_openstand2018_7').style.zIndex = 407;
        map.getPane('pane_openstand2018_7').style['mix-blend-mode'] = 'normal';
        var layer_openstand2018_7 = new L.geoJson(json_openstand2018_7, {
            attribution: '',
            interactive: true,
            dataVar: 'json_openstand2018_7',
            layerName: 'layer_openstand2018_7',
            pane: 'pane_openstand2018_7',
            onEachFeature: pop_openstand2018_7,
            style: style_openstand2018_7_0,
        });
        bounds_group.addLayer(layer_openstand2018_7);
        map.addLayer(layer_openstand2018_7);
        function pop_railway_8(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['id'] !== null ? autolinker.link(feature.properties['id'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_railway_8_0() {
            return {
                pane: 'pane_railway_8',
                opacity: 1,
                color: 'rgba(123,85,19,1.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(123,19,27,1.0)',
                interactive: false,
            }
        }
        map.createPane('pane_railway_8');
        map.getPane('pane_railway_8').style.zIndex = 408;
        map.getPane('pane_railway_8').style['mix-blend-mode'] = 'normal';
        var layer_railway_8 = new L.geoJson(json_railway_8, {
            attribution: '',
            interactive: false,
            dataVar: 'json_railway_8',
            layerName: 'layer_railway_8',
            pane: 'pane_railway_8',
            onEachFeature: pop_railway_8,
            style: style_railway_8_0,
        });
        bounds_group.addLayer(layer_railway_8);
        map.addLayer(layer_railway_8);
        function pop_majorroad_9(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <td colspan="2">' + (feature.properties['fid'] !== null ? autolinker.link(feature.properties['fid'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }

        function style_majorroad_9_0() {
            return {
                pane: 'pane_majorroad_9',
                opacity: 1,
                color: 'rgba(35,35,35,0.0)',
                dashArray: '',
                lineCap: 'butt',
                lineJoin: 'miter',
                weight: 1.0, 
                fill: true,
                fillOpacity: 1,
                fillColor: 'rgba(204,67,22,1.0)',
                interactive: false,
            }
        }
        map.createPane('pane_majorroad_9');
        map.getPane('pane_majorroad_9').style.zIndex = 409;
        map.getPane('pane_majorroad_9').style['mix-blend-mode'] = 'normal';
        var layer_majorroad_9 = new L.geoJson(json_majorroad_9, {
            attribution: '',
            interactive: false,
            dataVar: 'json_majorroad_9',
            layerName: 'layer_majorroad_9',
            pane: 'pane_majorroad_9',
            onEachFeature: pop_majorroad_9,
            style: style_majorroad_9_0,
        });
        bounds_group.addLayer(layer_majorroad_9);
        map.addLayer(layer_majorroad_9);
        map.createPane('pane_risklevel_10');
        map.getPane('pane_risklevel_10').style.zIndex = 410;
        var img_risklevel_10 = 'data/risklevel_10.png';
        var img_bounds_risklevel_10 = [[59.867317251367574,20.760901703400947],[61.34244116858048,24.174993926484998]];
        var layer_risklevel_10 = new L.imageOverlay(img_risklevel_10,
                                              img_bounds_risklevel_10,
                                              {pane: 'pane_risklevel_10'});
        bounds_group.addLayer(layer_risklevel_10);
        map.addLayer(layer_risklevel_10);
        function pop_mainexamplearea_11(feature, layer) {
            layer.on({
                mouseout: function(e) {
                    for (var i in e.target._eventParents) {
                        if (typeof e.target._eventParents[i].resetStyle === 'function') {
                            e.target._eventParents[i].resetStyle(e.target);
                        }
                    }
                },
                mouseover: highlightFeature,
				click:zoomToFeature,
            });
            var popupContent = '<table>\
                    <tr>\
                        <th scope="row">examples</th>\
                        <td class="visible-with-data" id="examples">' + (feature.properties['examples'] !== null ? autolinker.link(feature.properties['examples'].toLocaleString()) : '') + '</td>\
                    </tr>\
                </table>';
            var content = removeEmptyRowsFromPopupContent(popupContent, feature);
			layer.on('popupopen', function(e) {
				addClassToPopupIfMedia(content, e.popup);
			});
			layer.bindPopup(content, { maxHeight: 400 });
        }
		
        function style_mainexamplearea_11_0(feature) {
            switch(String(feature.properties['examples'])) {
                case 'bad area':
                    return {
                pane: 'pane_mainexamplearea_11',
				color: 'red', // Asetetaan 'bad area' punaiseksi
                weight: 2,
                fillOpacity: 0.5,
                interactive: true,
            }
                    break;
                case 'good area':
                    return {
                pane: 'pane_mainexamplearea_11',
				color: 'blue', // Asetetaan 'good area' vihreäksi
                weight: 2,
                fillOpacity: 0.5,
                interactive: true,
            }
                    break;
                default:
                    return {
                pane: 'pane_mainexamplearea_11',
                interactive: true,
            }
                    break;
            }
        }
        map.createPane('pane_mainexamplearea_11');
        map.getPane('pane_mainexamplearea_11').style.zIndex = 411;
        map.getPane('pane_mainexamplearea_11').style['mix-blend-mode'] = 'normal';
        var layer_mainexamplearea_11 = new L.geoJson(json_mainexamplearea_11, {
            attribution: '',
            interactive: true,
            dataVar: 'json_mainexamplearea_11',
            layerName: 'layer_mainexamplearea_11',
            pane: 'pane_mainexamplearea_11',
            onEachFeature: pop_mainexamplearea_11,
            style: style_mainexamplearea_11_0,
        });
        bounds_group.addLayer(layer_mainexamplearea_11);
        map.addLayer(layer_mainexamplearea_11);
        map.on("zoomend", function(e) {
            if (map.getZoom() <= 19 && map.getZoom() >= 9) {
                map.addLayer(layer_flyingsquirrelshabitat_2);
            } else if (map.getZoom() > 19 || map.getZoom() < 9) {
                map.removeLayer(layer_flyingsquirrelshabitat_2);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2024_3);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2024_3);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2022_4);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2022_4);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2021_5);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2021_5);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2020_6);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2020_6);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_openstand2018_7);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_openstand2018_7);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 12) {
                map.addLayer(layer_railway_8);
            } else if (map.getZoom() > 19 || map.getZoom() < 12) {
                map.removeLayer(layer_railway_8);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 12) {
                map.addLayer(layer_majorroad_9);
            } else if (map.getZoom() > 19 || map.getZoom() < 12) {
                map.removeLayer(layer_majorroad_9);
            }
            if (map.getZoom() <= 11 && map.getZoom() >= 8) {
                map.addLayer(layer_risklevel_10);
            } else if (map.getZoom() > 11 || map.getZoom() < 8) {
                map.removeLayer(layer_risklevel_10);
            }
            if (map.getZoom() <= 11 && map.getZoom() >= 2) {
                map.addLayer(layer_mainexamplearea_11);
            } else if (map.getZoom() > 11 || map.getZoom() < 2) {
                map.removeLayer(layer_mainexamplearea_11);
            }
        });
            if (map.getZoom() <= 19 && map.getZoom() >= 9) {
                map.addLayer(layer_flyingsquirrelshabitat_2);
            } else if (map.getZoom() > 19 || map.getZoom() < 9) {
                map.removeLayer(layer_flyingsquirrelshabitat_2);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2024_3);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2024_3);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2022_4);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2022_4);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2021_5);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2021_5);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_clearcutarea2020_6);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_clearcutarea2020_6);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 11) {
                map.addLayer(layer_openstand2018_7);
            } else if (map.getZoom() > 19 || map.getZoom() < 11) {
                map.removeLayer(layer_openstand2018_7);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 12) {
                map.addLayer(layer_railway_8);
            } else if (map.getZoom() > 19 || map.getZoom() < 12) {
                map.removeLayer(layer_railway_8);
            }
            if (map.getZoom() <= 19 && map.getZoom() >= 12) {
                map.addLayer(layer_majorroad_9);
            } else if (map.getZoom() > 19 || map.getZoom() < 12) {
                map.removeLayer(layer_majorroad_9);
            }
            if (map.getZoom() <= 11 && map.getZoom() >= 8) {
                map.addLayer(layer_risklevel_10);
            } else if (map.getZoom() > 11 || map.getZoom() < 8) {
                map.removeLayer(layer_risklevel_10);
            }
            if (map.getZoom() <= 11 && map.getZoom() >= 2) {
                map.addLayer(layer_mainexamplearea_11);
            } else if (map.getZoom() > 11 || map.getZoom() < 2) {
                map.removeLayer(layer_mainexamplearea_11);
            }
        var baseMaps = {};
        var overlaysTree = [
            {label: 'main example area<br /><table><tr><td style="text-align: center;"><img src="legend/mainexamplearea_11_badarea0.png" /></td><td>bad area</td></tr><tr><td style="text-align: center;"><img src="legend/mainexamplearea_11_goodarea1.png" /></td><td>good area</></td><td></td></tr></table>', layer: layer_mainexamplearea_11},
            {label: "risk level", layer: layer_risklevel_10},
        {label: '<b>Risks</b>', selectAllCheckbox: true, children: [
            {label: '<img src="legend/majorroad_9.png" /> major road', layer: layer_majorroad_9},
            {label: '<img src="legend/railway_8.png" /> railway', layer: layer_railway_8},
            {label: '<img src="legend/openstand2018_7.png" /> open stand 2018', layer: layer_openstand2018_7},
            {label: '<img src="legend/clearcutarea2020_6.png" /> clear-cut area 2020', layer: layer_clearcutarea2020_6},
            {label: '<img src="legend/clearcutarea2021_5.png" /> clear-cut area 2021', layer: layer_clearcutarea2021_5},
            {label: '<img src="legend/clearcutarea2022_4.png" /> clear-cut area 2022', layer: layer_clearcutarea2022_4},
            {label: '<img src="legend/clearcutarea2024_3.png" /> clear-cut area 2024', layer: layer_clearcutarea2024_3},]},
            {label: "flying squirrel's habitat", layer: layer_flyingsquirrelshabitat_2},
            {label: '<img src="legend/smallerroad_1.png" /> smaller road', layer: layer_smallerroad_1},
            {label: "basemap", layer: layer_basemap_0},]
        var lay = L.control.layers.tree(null, overlaysTree,{
            //namedToggle: true,
            //selectorBack: false,
            //closedSymbol: '&#8862; &#x1f5c0;',
            //openedSymbol: '&#8863; &#x1f5c1;',
            //collapseAll: 'Collapse all',
            //expandAll: 'Expand all',
            collapsed: false, 
        });
        lay.addTo(map);
		document.addEventListener("DOMContentLoaded", function() {
            // set new Layers List height which considers toggle icon
            function newLayersListHeight() {
                var layerScrollbarElement = document.querySelector('.leaflet-control-layers-scrollbar');
                if (layerScrollbarElement) {
                    var layersListElement = document.querySelector('.leaflet-control-layers-list');
                    var originalHeight = layersListElement.style.height 
                        || window.getComputedStyle(layersListElement).height;
                    var newHeight = parseFloat(originalHeight) - 50;
                    layersListElement.style.height = newHeight + 'px';
                }
            }
            var isLayersListExpanded = true;
            var controlLayersElement = document.querySelector('.leaflet-control-layers');
            var toggleLayerControl = document.querySelector('.leaflet-control-layers-toggle');
            // toggle Collapsed/Expanded and apply new Layers List height
            toggleLayerControl.addEventListener('click', function() {
                if (isLayersListExpanded) {
                    controlLayersElement.classList.remove('leaflet-control-layers-expanded');
                } else {
                    controlLayersElement.classList.add('leaflet-control-layers-expanded');
                }
                isLayersListExpanded = !isLayersListExpanded;
                newLayersListHeight()
            });	
			// apply new Layers List height if toggle layerstree
			if (controlLayersElement) {
				controlLayersElement.addEventListener('click', function(event) {
					var toggleLayerHeaderPointer = event.target.closest('.leaflet-layerstree-header-pointer span');
					if (toggleLayerHeaderPointer) {
						newLayersListHeight();
					}
				});
			}
            // Collapsed/Expanded at Start to apply new height
            setTimeout(function() {
                toggleLayerControl.click();
            }, 10);
            setTimeout(function() {
                toggleLayerControl.click();
            }, 10);
            // Collapsed touch/small screen
            var isSmallScreen = window.innerWidth < 650;
            if (isSmallScreen) {
                setTimeout(function() {
                    controlLayersElement.classList.remove('leaflet-control-layers-expanded');
                    isLayersListExpanded = !isLayersListExpanded;
                }, 500);
            }  
        });       
        setBounds();
        L.ImageOverlay.include({
            getBounds: function () {
                return this._bounds;
            }
        });
        </script>
    </body>
</html>
